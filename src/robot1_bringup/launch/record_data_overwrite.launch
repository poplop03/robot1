<launch>
  <arg name="output_dir" default="/home/duc/rosbags"/>
  <arg name="bag_prefix" default="slam_data"/>

  <!-- Record all topics -->
  <node name="rosbag_recorder" pkg="rosbag" type="record" output="screen"
        args="-a -o $(arg output_dir)/$(arg bag_prefix)" />

  <!-- Rename latest bag file -->
  <node name="rename_latest_bag" pkg="rosbash" type="rosbash" output="screen"
        launch-prefix="bash -c"
        args="sleep 5 &amp;&amp; latest=\$(ls -t &quot;$(arg output_dir)&quot;/*.bag | head -n 1) &amp;&amp; mv -f &quot;\$latest&quot; &quot;$(arg output_dir)/data.bag&quot; &amp;&amp; find &quot;$(arg output_dir)&quot; -type f -name '*.bag' ! -name 'data.bag' -delete &amp;&amp; echo 'Renamed to data.bag'" />
</launch>
